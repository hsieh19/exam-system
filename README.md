# 企业考试系统 (Enterprise Examination System)

一个简洁、高效的企业内部在线考试系统。基于 HTML5/CSS3/JS + Node.js (Express) + SQLite (sql.js) 构建。

## ✨ 核心特性

###  考生功能
- **在线考试**：支持单选、多选、判断三种标准题型。
- **智能计时**：支持考试总时长倒计时限制。
- **成绩与回顾**：考试结束后自动评分，支持多选题漏选得部分分机制。
- **排行榜**：查看针对特定试卷的成绩排行榜。

### 🛠️ 管理员功能
- **题库管理**：
  - 专业分类管理。
  - 题目的增删改查。
- **用户与分组**：
  - 用户管理：增删改查用户，支持重置密码和修改分组。
  - 分组管理：创建和管理用户部门/分组。
- **系统安全与审计**：
  - **系统日志**：记录用户登录、数据库切换、题目和试卷操作等关键日志。
  - **操作回溯**：超级管理员可以按操作类型、操作对象、日期等维度筛选和检索日志。
- **试卷编排**：
  - **规则组卷**：设定不同题型数量、分值、漏选分和答题时限。
  - **手动选题**：支持从题库中手动挑选题目。
  - **自动生成**：根据规则随机从题库中抽取题目。
- **考试发布**：
  - 将试卷定向推送到指定的分组。
  - 设定考试截止时间。
- **多数据库切换**：支持 SQLite、MySQL、PostgreSQL 之间的一键切换和热迁移。

## 🚀 安装与部署

本项目支持 Windows 本地开发及 Linux 生产环境部署。

### 💻 方式一：Linux 一键部署（推荐）

使用 `run.sh` 脚本可以全面管理项目生命周期。

1.  **下载项目**：
    ```bash
    git clone https://github.com/hsieh19/exam-system.git
    cd exam-system
    ```

2.  **初始化与运行**：
    ```bash
    chmod +x run.sh   # 赋予脚本执行权限
    ./run.sh
    ```
    
    在出现的菜单中选择 **`1. 启动服务`**。脚本将自动检测环境、安装 Node.js（如果缺失）、安装 npm 依赖并启动服务。

3.  **系统更新**：
    运行 `./run.sh` 并选择 **`9. 系统更新`**。
    *   脚本会自动检测 GitHub 最新 Release。
    *   自动备份当前数据和配置。
    *   下载并应用更新包。
    *   保留原有数据库和配置文件。

4.  **其他管理功能**：
    *   `2. 停止服务`：优雅停止后台进程。
    *   `3. 重启服务`：应用配置更改后使用。
    *   `4. 查看状态`：检查服务运行健康度。
    *   `5. 查看日志`：实时追踪系统运行日志。
    *   `7. 初始化数据库`：首次部署时可选，重置数据库状态。

### 🛠️ 方式二：本地开发 (Windows/Mac)

1.  **环境要求**：Node.js v14.0+
2.  **安装依赖**：
    ```bash
    npm install
    # 推荐使用淘宝镜像: npm install --registry=https://registry.npmmirror.com
    ```
3.  **配置环境**：
    复制 `.env.example` 为 `.env`，根据需要配置数据库连接信息。
4.  **运行服务**：
    ```bash
    npm start
    ```
5.  **访问**：打开浏览器访问 `http://localhost:3000`

## ⚙️ 默认账号

> ⚠️ **生产环境安全提示**：请在首次登录后立即修改默认管理员密码。

| 角色 | 用户名 | 默认密码 | 权限说明 |
|------|--------|----------|----------|
| **超级管理员** | `admin` | `admin123` | 全权管理（系统日志、数据库设置、所有题库/试卷） |
| **分组管理员** | (需创建) | - | 仅管理本分组的题库、试卷和考生 |
| **考生** | `student` | `123456` | 参加考试、查询个人成绩 |

## 🏗️ 技术架构

- **前端**：Vanilla JavaScript (ES6+), CSS3 (Flexbox), HTML5
- **后端**：Node.js + Express
- **数据库自适应层**：
  - **SQLite**：小型部署，本地文件持久化 (`exam.db`)。
  - **MySQL**：适用于中型企业级部署。
  - **PostgreSQL**：适用于对数据一致性要求高的场景。

## 📂 目录结构

```text
├── .github/            # GitHub 配置（如 workflows）
├── docs/               # 项目文档 (run.md)
├── public/             # 静态资源 (HTML, CSS, JS)
│   ├── index.html      # 登录页
│   ├── admin.html      # 管理端主页
│   ├── student.html    # 考生端主页
│   ├── exam.html       # 考试进行页
│   ├── css/            # 样式表
│   └── js/             # 前端逻辑 (storage.js, admin.js 等)
├── src/                # 后端源码
│   ├── server.js       # 后端服务入口
│   ├── db/             # 数据库层 (db-adapter.js 支持多种数据库)
│   └── config/         # 配置文件
├── db/                 # 数据库文件存储 (exam.db)
├── .env                # 环境配置文件 (数据库连接信息)
├── .gitignore          # Git 忽略配置
├── package.json        # 项目依赖与配置
└── run.sh              # 综合管理脚本
```

## 🔒 考试评分规则

1.  **单选题**：选中正确选项得全分，否则0分。
2.  **判断题**：判断正确得全分，否则0分。
3.  **多选题**：
    *   全对：得该题设定满分。
    *   漏选：得设定部分分。
    *   错选/多选：0分。

## 📱 兼容性
适配现代浏览器（Chrome/Edge/Firefox）。
